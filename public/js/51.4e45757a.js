(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[51],{d09f:function(t,e,o){"use strict";o.r(e);var i=o("448a"),a=o.n(i),r=(o("ac1f"),o("841c"),o("99af"),function(){var t=this,e=t._self._c;return e("q-page",{staticClass:"bg-grey-1",attrs:{padding:""}},[e("q-header",{class:t.getHeaderColorBrand},[e("q-toolbar",[e("q-btn",{attrs:{to:{name:"PromoIndex",query:{q:"promo"}},flat:"",round:"",dense:"",icon:"eva-arrow-back"}}),e("q-toolbar-title",[t.promo?e("span",[t._v(t._s(t.promo.label))]):t._e()]),e("q-btn",{attrs:{color:"white","text-color":"grey-8",size:"13px",unelevated:"",icon:"add_circle",label:"Produk"},on:{click:t.handleAddProductPromo}})],1)],1),t.promo?e("div",[e("q-card",{attrs:{bordered:"",flat:""}},[e("q-card-section",[e("q-list",{attrs:{separator:""}},[e("q-item",[e("q-item-section",[t._v("Label")]),e("q-item-section",[t._v(t._s(t.promo.label))])],1),e("q-item",[e("q-item-section",[t._v("Start")]),e("q-item-section",[t._v(t._s(t.promo.start))])],1),e("q-item",[e("q-item-section",[t._v("Selesai")]),e("q-item-section",[t._v(t._s(t.promo.start))])],1),e("q-item",[e("q-item-section",[t._v("Status")]),e("q-item-section",[e("q-item-label",[e("q-badge",{staticClass:"q-px-md q-py-xs rounded-borders text-white",class:t.promo.is_active?"bg-green":"bg-grey-7"},[t._v(t._s(t.promo.is_active?"Active":"Inactive"))])],1)],1)],1)],1)],1)],1),e("q-separator")],1):t._e(),e("q-card",{staticClass:"q-mt-lg",attrs:{bordered:"",flat:""}},[e("q-card-section",[t.promo?e("div",[e("div",{staticClass:"text-md text-weight-bold q-mb-md"},[t._v("Total Produk "+t._s(t.products.length))]),e("div",{},[e("q-list",{attrs:{separator:""}},[e("q-item",{staticClass:"item-header"},[e("q-item-section",{attrs:{side:""}},[t._v("#")]),e("q-item-section",[t._v("Nama Produk")]),e("q-item-section",[t._v("Diskon")]),e("q-item-section",{attrs:{side:""}},[t._v("Actions")])],1),t._l(t.products,(function(o,i){return e("q-item",{key:i},[e("q-item-section",{attrs:{side:""}},[t._v(t._s(i+1))]),e("q-item-section",[t._v(t._s(o.title))]),e("q-item-section",[t._v(t._s("PERCENT"==o.pivot.discount_type?o.pivot.discount_amount+" %":t.moneyIDR(o.pivot.discount_amount)))]),e("q-item-section",{attrs:{side:""}},[e("div",{staticClass:"q-gutter-sm flex"},[e("q-btn",{attrs:{icon:"eva-edit-2",unelevated:"",round:"",size:"11px",color:"blue",disable:t.syncLoading},on:{click:function(e){return t.handleEdit(o)}}}),e("q-btn",{attrs:{icon:"eva-trash-2",size:"11px",round:"",unelevated:"",color:"red",disable:t.syncLoading},on:{click:function(e){return t.handleRemoveProductPromo(o.id)}}})],1)])],1)}))],2),t.products.length?t._e():e("div",{staticClass:"text-center q-py-md"},[t._v("Tidak ada data")])],1)]):t._e()])],1),e("q-dialog",{attrs:{persistent:"",position:"bottom"},model:{value:t.searchModal,callback:function(e){t.searchModal=e},expression:"searchModal"}},[e("q-card",{staticClass:"max-width"},[e("div",{staticClass:"sticky-top bg-white"},[e("div",{staticClass:"flex justify-between items-center card-heading"},[e("div",{},[t._v("Pilih Produk")]),e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",round:"",padding:"0px",flat:""}})],1),e("div",{staticClass:"q-px-md q-py-sm box-shadow q-gutter-x-sm row items-center"},[e("q-input",{staticClass:"col",attrs:{outlined:"",placeholder:"Find by name",dense:"",type:"search",clearable:""},on:{clear:function(){return t.formFilter.search=""}},model:{value:t.formFilter.search,callback:function(e){t.$set(t.formFilter,"search",e)},expression:"formFilter.search"}}),e("q-select",{staticClass:"col",attrs:{outlined:"",dense:"",options:[{label:"All",value:""}].concat(a()(t.categories)),"map-options":"","emit-value":"",label:"Filter Bby Category"},model:{value:t.formFilter.category_id,callback:function(e){t.$set(t.formFilter,"category_id",e)},expression:"formFilter.category_id"}}),e("q-btn",{attrs:{color:"primary",unelevated:""},on:{click:t.findProduct}},[t._v("Filter")])],1)]),e("q-card-section",{staticClass:"q-gutter-y-sm",staticStyle:{"min-height":"250px","overflow-y":"auto"}},[t.productSearch.length?e("div",[e("q-list",{attrs:{separator:""}},t._l(t.productSearch,(function(o){return e("q-item",{key:o.id,attrs:{clickable:""},on:{click:function(e){return t.syncProduct(o)}}},[e("q-item-section",[t._v(t._s(o.title))])],1)})),1)],1):t._e(),e("q-inner-loading",{attrs:{showing:t.isLoading}}),t.notFound?e("div",{staticClass:"text-center q-pt-lg"},[t._v("Tidak ada data ditemukan")]):t._e()],1)],1)],1),e("q-dialog",{attrs:{persistent:""},model:{value:t.productPromoModal,callback:function(e){t.productPromoModal=e},expression:"productPromoModal"}},[t.productSelected?e("q-card",{staticClass:"card-medium"},[e("q-card-section",[e("div",{staticClass:"text-md text-weight-bold q-mb-md"},[t._v("Produk "+t._s(t.productSelected.title))]),e("form",{on:{submit:function(e){return e.preventDefault(),t.submitProductPromo.apply(null,arguments)}}},[e("div",{staticClass:"flex items-center q-mt-sm full-width q-gutter-x-sm"},[e("q-input",{staticClass:"col",attrs:{required:"",filled:"",square:"",label:"Diskon Nominal",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_amount,callback:function(e){t.$set(t.form,"discount_amount",e)},expression:"form.discount_amount"}}),e("q-select",{staticClass:"col",attrs:{required:"",filled:"",square:"",label:"Diskon Tipe",options:t.discountTypeOptions,"emit-value":"","map-options":"",rules:[function(t){return!!t||"Field is required"}]},model:{value:t.form.discount_type,callback:function(e){t.$set(t.form,"discount_type",e)},expression:"form.discount_type"}})],1),e("div",{staticClass:"flex justify-end q-gutter-x-sm q-mt-md"},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{label:"Close",outline:"",color:"primary"}}),e("q-btn",{attrs:{type:"submit",label:"Submit",unelevated:"",color:"primary"}})],1)])])],1):t._e()],1)],1)}),s=[],n=(o("d3b7"),o("e6cf"),o("a79d"),o("25f0"),o("e260"),o("3ca3"),o("ddb0"),o("2b3d"),o("d81d"),o("758b")),c={name:"ProductPromo",data:function(){return{productPromoModal:!1,productSelected:null,product_ids:[],promo:null,isLoading:!1,syncLoading:!1,searchModal:!1,formFilter:{search:"",category_id:""},productSearch:[],categories:[],products:[],form:{promo_id:null,product_id:null,discount_amount:0,discount_type:"PERCENT"},discountTypeOptions:[{value:"PERCENT",label:"Persen"},{value:"AMOUNT",label:"Nominal"}],removeId:null,notFound:!1}},methods:{getPromoDetail:function(){var t=this;Object(n["a"])().get("promo/detail/"+this.$route.params.id).then((function(e){200==e.status&&e.data.success&&(t.products=e.data.results.products,t.promo=e.data.results.promo)}))},getProductPromo:function(){var t=this;Object(n["a"])().get("products/promo/"+this.$route.params.id).then((function(e){200==e.status&&e.data.success&&(t.products=e.data.results)}))},findProduct:function(){var t=this;this.isLoading=!0,this.notFound=!1,this.productSearch=[],Object(n["a"])().get("promo/find-product?"+new URLSearchParams(this.formFilter).toString()).then((function(e){200==e.status&&e.data.success&&(t.productSearch=e.data.results,t.productSearch.length||(t.notFound=!0))})).finally((function(){t.isLoading=!1}))},handleEdit:function(t){this.productSelected=t,this.form.product_id=t.id,this.form.promo_id=this.promo.id,this.form.discount_amount=t.pivot.discount_amount,this.form.discount_type=t.pivot.discount_type,this.productPromoModal=!0},handleAddProductPromo:function(){this.formFilter.search="",this.formFilter.category_id="",this.searchModal=!0,this.productSearch=[]},syncProduct:function(t){this.productSelected=t,this.form.product_id=t.id,this.form.promo_id=this.promo.id,this.searchModal=!1,this.productPromoModal=!0},submitProductPromo:function(){var t=this;"PERCENT"==this.form.discount_type&&(0==this.form.discount_amount||this.form.discount_amount>=99)?this.$q.notify({type:"negative",message:"Tentukan nilai nominal diskon dengan benar"}):Object(n["a"])().post("promo/submit-product",this.form).then((function(){t.getProductPromo()})).finally((function(){return t.productPromoModal=!1}))},handleRemoveProductPromo:function(t){var e=this;this.removeId=t,this.$q.dialog({title:"Konnfirmasi",message:"Yakin akan menghapus data?",cancel:!0}).onOk((function(){e.removeProductPromo()}))},removeProductPromo:function(){var t=this;Object(n["a"])().post("promo/remove",{promo_id:this.promo.id,product_id:this.removeId}).then((function(){return t.getProductPromo()}))},getAllCategories:function(){var t=this;this.$store.dispatch("front/getCategories",{only:"parent"}).then((function(e){t.categories=e.data.results.map((function(t){return{label:t.title,value:t.id}}))}))}},mounted:function(){this.getPromoDetail(),this.getAllCategories()}},d=c,l=o("2877"),u=o("9989"),m=o("e359"),p=o("65c6"),f=o("9c40"),h=o("6ac5"),v=o("f09f"),q=o("a370"),_=o("1c1c"),b=o("66e5"),g=o("4074"),P=o("0170"),y=o("58a81"),k=o("eb85"),C=o("24e8"),x=o("27f9"),S=o("ddd8"),w=o("74f7"),F=o("7f67"),Q=o("eebe"),T=o.n(Q),M=Object(l["a"])(d,r,s,!1,null,null,null);e["default"]=M.exports;T()(M,"components",{QPage:u["a"],QHeader:m["a"],QToolbar:p["a"],QBtn:f["a"],QToolbarTitle:h["a"],QCard:v["a"],QCardSection:q["a"],QList:_["a"],QItem:b["a"],QItemSection:g["a"],QItemLabel:P["a"],QBadge:y["a"],QSeparator:k["a"],QDialog:C["a"],QInput:x["a"],QSelect:S["a"],QInnerLoading:w["a"]}),T()(M,"directives",{ClosePopup:F["a"]})}}]);